{"ast":null,"code":"import React,{useState}from'react';import{Box,Container,TextField,Button,Typography,Paper,Alert,Link,CircularProgress}from'@mui/material';import{useNavigate,Link as RouterLink}from'react-router-dom';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Register=()=>{const navigate=useNavigate();const[formData,setFormData]=useState({email:'',password:'',confirmPassword:'',name:'',department:''});const[error,setError]=useState('');const[loading,setLoading]=useState(false);const handleChange=e=>{const{name,value}=e.target;setFormData(prevState=>({...prevState,[name]:value}));};const handleSubmit=async e=>{e.preventDefault();setError('');// ตรวจสอบข้อมูล\nif(!formData.email||!formData.password||!formData.name||!formData.department){setError('กรุณากรอกข้อมูลให้ครบทุกช่อง');return;}if(formData.password!==formData.confirmPassword){setError('รหัสผ่านไม่ตรงกัน');return;}const emailRegex=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;if(!emailRegex.test(formData.email)){setError('กรุณากรอกอีเมลให้ถูกต้อง');return;}if(formData.password.length<6){setError('รหัสผ่านต้องมีความยาวอย่างน้อย 6 ตัวอักษร');return;}setLoading(true);try{await axios.post('http://localhost:3001/api/register',{email:formData.email,password:formData.password,name:formData.name,department:formData.department});// ลงทะเบียนสำเร็จ นำผู้ใช้ไปยังหน้า login\nnavigate('/login',{state:{message:'ลงทะเบียนสำเร็จ กรุณาเข้าสู่ระบบ'}});}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||'เกิดข้อผิดพลาดในการลงทะเบียน');}finally{setLoading(false);}};return/*#__PURE__*/_jsx(Container,{component:\"main\",maxWidth:\"xs\",children:/*#__PURE__*/_jsx(Box,{sx:{marginTop:8,display:'flex',flexDirection:'column',alignItems:'center'},children:/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{padding:4,width:'100%'},children:[/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h5\",align:\"center\",gutterBottom:true,children:\"\\u0E2A\\u0E21\\u0E31\\u0E04\\u0E23\\u0E2A\\u0E21\\u0E32\\u0E0A\\u0E34\\u0E01\"}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:handleSubmit,noValidate:true,children:[/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,id:\"name\",label:\"\\u0E0A\\u0E37\\u0E48\\u0E2D-\\u0E19\\u0E32\\u0E21\\u0E2A\\u0E01\\u0E38\\u0E25\",name:\"name\",autoComplete:\"name\",autoFocus:true,value:formData.name,onChange:handleChange,disabled:loading}),/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,id:\"email\",label:\"\\u0E2D\\u0E35\\u0E40\\u0E21\\u0E25\",name:\"email\",autoComplete:\"email\",value:formData.email,onChange:handleChange,disabled:loading}),/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,id:\"department\",label:\"\\u0E41\\u0E1C\\u0E19\\u0E01\",name:\"department\",value:formData.department,onChange:handleChange,disabled:loading}),/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,name:\"password\",label:\"\\u0E23\\u0E2B\\u0E31\\u0E2A\\u0E1C\\u0E48\\u0E32\\u0E19\",type:\"password\",id:\"password\",autoComplete:\"new-password\",value:formData.password,onChange:handleChange,disabled:loading}),/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,name:\"confirmPassword\",label:\"\\u0E22\\u0E37\\u0E19\\u0E22\\u0E31\\u0E19\\u0E23\\u0E2B\\u0E31\\u0E2A\\u0E1C\\u0E48\\u0E32\\u0E19\",type:\"password\",id:\"confirmPassword\",autoComplete:\"new-password\",value:formData.confirmPassword,onChange:handleChange,disabled:loading}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",sx:{mt:3,mb:2},disabled:loading,children:loading?/*#__PURE__*/_jsx(CircularProgress,{size:24}):'สมัครสมาชิก'}),/*#__PURE__*/_jsx(Box,{sx:{mt:2,textAlign:'center'},children:/*#__PURE__*/_jsx(Link,{component:RouterLink,to:\"/login\",variant:\"body2\",sx:{textDecoration:'none'},children:\"\\u0E21\\u0E35\\u0E1A\\u0E31\\u0E0D\\u0E0A\\u0E35\\u0E2D\\u0E22\\u0E39\\u0E48\\u0E41\\u0E25\\u0E49\\u0E27? \\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E1A\"})})]})]})})});};export default Register;","map":{"version":3,"names":["React","useState","Box","Container","TextField","Button","Typography","Paper","Alert","Link","CircularProgress","useNavigate","RouterLink","axios","jsx","_jsx","jsxs","_jsxs","Register","navigate","formData","setFormData","email","password","confirmPassword","name","department","error","setError","loading","setLoading","handleChange","e","value","target","prevState","handleSubmit","preventDefault","emailRegex","test","length","post","state","message","err","_err$response","_err$response$data","response","data","component","maxWidth","children","sx","marginTop","display","flexDirection","alignItems","elevation","padding","width","variant","align","gutterBottom","severity","mb","onSubmit","noValidate","margin","required","fullWidth","id","label","autoComplete","autoFocus","onChange","disabled","type","mt","size","textAlign","to","textDecoration"],"sources":["C:/MyProjects/Orgforms/form-frontend/src/pages/register.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport {\r\n  Box,\r\n  Container,\r\n  TextField,\r\n  Button,\r\n  Typography,\r\n  Paper,\r\n  Alert,\r\n  Link,\r\n  CircularProgress\r\n} from '@mui/material';\r\nimport { useNavigate, Link as RouterLink } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nconst Register = () => {\r\n  const navigate = useNavigate();\r\n  const [formData, setFormData] = useState({\r\n    email: '',\r\n    password: '',\r\n    confirmPassword: '',\r\n    name: '',\r\n    department: ''\r\n  });\r\n  const [error, setError] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prevState => ({\r\n      ...prevState,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError('');\r\n\r\n    // ตรวจสอบข้อมูล\r\n    if (!formData.email || !formData.password || !formData.name || !formData.department) {\r\n      setError('กรุณากรอกข้อมูลให้ครบทุกช่อง');\r\n      return;\r\n    }\r\n\r\n    if (formData.password !== formData.confirmPassword) {\r\n      setError('รหัสผ่านไม่ตรงกัน');\r\n      return;\r\n    }\r\n\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(formData.email)) {\r\n      setError('กรุณากรอกอีเมลให้ถูกต้อง');\r\n      return;\r\n    }\r\n\r\n    if (formData.password.length < 6) {\r\n      setError('รหัสผ่านต้องมีความยาวอย่างน้อย 6 ตัวอักษร');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      await axios.post('http://localhost:3001/api/register', {\r\n        email: formData.email,\r\n        password: formData.password,\r\n        name: formData.name,\r\n        department: formData.department\r\n      });\r\n\r\n      // ลงทะเบียนสำเร็จ นำผู้ใช้ไปยังหน้า login\r\n      navigate('/login', { state: { message: 'ลงทะเบียนสำเร็จ กรุณาเข้าสู่ระบบ' } });\r\n    } catch (err) {\r\n      setError(err.response?.data?.error || 'เกิดข้อผิดพลาดในการลงทะเบียน');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <Box\r\n        sx={{\r\n          marginTop: 8,\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n        }}\r\n      >\r\n        <Paper elevation={3} sx={{ padding: 4, width: '100%' }}>\r\n          <Typography component=\"h1\" variant=\"h5\" align=\"center\" gutterBottom>\r\n            สมัครสมาชิก\r\n          </Typography>\r\n\r\n          {error && (\r\n            <Alert severity=\"error\" sx={{ mb: 2 }}>\r\n              {error}\r\n            </Alert>\r\n          )}\r\n\r\n          <Box component=\"form\" onSubmit={handleSubmit} noValidate>\r\n            <TextField\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              id=\"name\"\r\n              label=\"ชื่อ-นามสกุล\"\r\n              name=\"name\"\r\n              autoComplete=\"name\"\r\n              autoFocus\r\n              value={formData.name}\r\n              onChange={handleChange}\r\n              disabled={loading}\r\n            />\r\n            <TextField\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              id=\"email\"\r\n              label=\"อีเมล\"\r\n              name=\"email\"\r\n              autoComplete=\"email\"\r\n              value={formData.email}\r\n              onChange={handleChange}\r\n              disabled={loading}\r\n            />\r\n            <TextField\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              id=\"department\"\r\n              label=\"แผนก\"\r\n              name=\"department\"\r\n              value={formData.department}\r\n              onChange={handleChange}\r\n              disabled={loading}\r\n            />\r\n            <TextField\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              name=\"password\"\r\n              label=\"รหัสผ่าน\"\r\n              type=\"password\"\r\n              id=\"password\"\r\n              autoComplete=\"new-password\"\r\n              value={formData.password}\r\n              onChange={handleChange}\r\n              disabled={loading}\r\n            />\r\n            <TextField\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              name=\"confirmPassword\"\r\n              label=\"ยืนยันรหัสผ่าน\"\r\n              type=\"password\"\r\n              id=\"confirmPassword\"\r\n              autoComplete=\"new-password\"\r\n              value={formData.confirmPassword}\r\n              onChange={handleChange}\r\n              disabled={loading}\r\n            />\r\n\r\n            <Button\r\n              type=\"submit\"\r\n              fullWidth\r\n              variant=\"contained\"\r\n              sx={{ mt: 3, mb: 2 }}\r\n              disabled={loading}\r\n            >\r\n              {loading ? <CircularProgress size={24} /> : 'สมัครสมาชิก'}\r\n            </Button>\r\n\r\n            <Box sx={{ mt: 2, textAlign: 'center' }}>\r\n              <Link\r\n                component={RouterLink}\r\n                to=\"/login\"\r\n                variant=\"body2\"\r\n                sx={{ textDecoration: 'none' }}\r\n              >\r\n                มีบัญชีอยู่แล้ว? เข้าสู่ระบบ\r\n              </Link>\r\n            </Box>\r\n          </Box>\r\n        </Paper>\r\n      </Box>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Register; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}